on_monthly_pulse = {
    effect = {
        every_country = {
			limit = { is_at_war = yes }
			trigger_event = { id = check_casualties.1 }
		}
    }
}

on_diplo_play_war_start = {
	effect = {
		root = {
			target = {
				trigger_event = { id = check_casualties.1 }
			}
			initiator = {
				trigger_event = { id = check_casualties.1 }
			}
			every_scope_target_ally = {
				trigger_event = { id = check_casualties.1 }							
			}
			every_scope_initiator_ally = {
				trigger_event = { id = check_casualties.1 }									
			}
		}
	}
}

on_war_end = {
	effect = {
		every_character = {
			if = {
				limit = {
					has_variable = is_struct
					has_variable = war_tag
				}
				debug_log = war_ended
				debug_log_scopes = yes
				if = {
					limit = {
						root.war = var:war_tag
					}
					debug_log_scopes = yes
					root = {
						target ?= {
							set_local_variable = { name = current_war value = root.war }
							trigger_event = { id = check_casualties.2 }
						}
						initiator ?= {
							set_local_variable = { name = current_war value = root.war }
							trigger_event = { id = check_casualties.2 }
						}
						every_scope_target_ally ?= {
							set_local_variable = { name = current_war value = root.war }
							trigger_event = { id = check_casualties.2 }							
						}
						every_scope_initiator_ally ?= {
							set_local_variable = { name = current_war value = root.war }
							trigger_event = { id = check_casualties.2 }									
						}
					}
				}
			}		
		}
	}
}

